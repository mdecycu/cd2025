<!DOCTYPE html><html>
        <head>
        <title>cd2025</title>
        <meta charset="utf-8">
<meta property="head" content="H2">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/icomoon/style.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/magnific-popup.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/jquery-ui.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.carousel.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/owl.theme.default.min.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/bootstrap-datepicker.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/fonts/flaticon/font/flaticon.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/aos.css">
        <link rel="stylesheet" href="./../cmsimde/static/chimper/css/style.css">
        <link rel="shortcut icon" href="./../cmsimde/static/favicons.png">
        
        <style type='text/css'>
            .site-section {
            background-color: #FFFF;
            padding: 40px 40px;
            }
            body > div > div.dropdown.open {
                display: block;
            }
        </style>
    
        <!-- <script src="./../cmsimde/static/jquery.js"></script> -->
        <!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script> -->
        <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/normalize.min.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch_set.js"></script>
        <script src="tipuesearch_content.js"></script>
        <link rel="stylesheet" href="./../cmsimde/static/tipuesearch/css/tipuesearch.css">
        <script src="./../cmsimde/static/tipuesearch/tipuesearch.js"></script>
        <!-- for Wink3 客製化關閉 -->
        <!--
        <link rel="stylesheet" type="text/css" href="./../cmsimde/static/winkPlayer.css" />
        <script type="text/javascript" src="./../cmsimde/static/winkPlayer.js"></script>
        -->
        <script>
            /* original tipuesearch
            $(document).ready(function() {
                 $('#tipue_search_input').tipuesearch();
            });
            */
            // customed doSearch
            function doSearch() {
                $('#tipue_search_input').tipuesearch({
                    newWindow: true, 
                    minimumLength: 2,
                    wholeWords: false, // for search 中文
                });
            }
            $(document).ready(doSearch);
        </script>
        
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shCore.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushBash.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDiff.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJScript.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushJava.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPython.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushSql.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushHaxe.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushXml.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPhp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushPowerShell.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushLua.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushMojo.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushWbt.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCpp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCss.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushCSharp.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushDart.js"></script>
<script type="text/javascript" src="./../cmsimde/static/syntaxhighlighter/shBrushRust.js"></script>
<link type="text/css" rel="stylesheet" href="./../cmsimde/static/syntaxhighlighter/css/shCoreDefault.css"/>
<script type="text/javascript">SyntaxHighlighter.all();</script>
<!-- 暫時不用
<script src="./../cmsimde/static/fengari-web.js"></script>
<script type="text/javascript" src="./../cmsimde/static/Cango-13v08-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/CangoAxes-4v01-min.js"></script>
<script type="text/javascript" src="./../cmsimde/static/gearUtils-05.js"></script>
-->
<!-- for Brython 暫時不用
<script src="https://scrum-3.github.io/web/brython/brython.js"></script>
<script src="https://scrum-3.github.io/web/brython/brython_stdlib.js"></script>
-->
<style>
img.add_border {
    border: 3px solid blue;
}
</style>

</head>
<body>
<div class='container'><nav>
        
    <div class="site-wrap">

    <div class="site-mobile-menu">
      <div class="site-mobile-menu-header">
        <div class="site-mobile-menu-close mt-3">
          <span class="icon-close2 js-menu-toggle"></span>
        </div>
      </div>
      <div class="site-mobile-menu-body"></div>
    </div>
    
            <header class="site-navbar py-4 bg-white" role="banner">
              <div class="container">
                <div class="row align-items-center">
                <h1>cd2025 協同產品設計實習</h1>
                <div class="pl-4">
                    <form>
                    <input type="text" placeholder="Search" name="q" id="tipue_search_input" pattern=".{2,}" title="At least 2 characters" required>
                    </form>
                </div>
                  <!-- <div class="col-11 col-xl-2">
                    <h1 class="mb-0 site-logo"><a href="index.html" class="text-black h2 mb-0">cd2025 協同產品設計實習</a></h1> 
                  </div>
                  -->
                  <div class="col-12 col-md-10 d-none d-xl-block">
                    <nav class="site-navigation position-relative text-right" role="navigation">
    <ul class='site-menu js-clone-nav mr-auto d-none d-lg-block'>
                        <li class="active has-children"><a href="index.html">Home</a>
                        <ul class="dropdown">
                            <li><a href="sitemap.html">SMap</a></li>
                            <li><a href="./../reveal/index.html">reveal</a></li>
                            <li><a href="./../blog/index.html">blog</a></li>
                        </ul>
                      </li>
                     <li class='has-children'><a href='About.html'>About</a><ul class='dropdown'><li class='has-children'><a href='Summary.html'>Summary</a><ul class='dropdown'><li><a href='Tasks.html'>Tasks</a><li><a href='Closing.html'>Closing</a><li><a href='Shooter.html'>Shooter</a></li></ul><li><a href='Product.html'>Product</a><li><a href='Control.html'>Control</a><li><a href='CPS.html'>CPS</a><li><a href='AI.html'>AI</a><li><a href='Project.html'>Project</a></li></ul><li class='has-children'><a href='Topics.html'>Topics</a><ul class='dropdown'><li class='has-children'><a href='Wink.html'>Wink</a><ul class='dropdown'><li><a href='Fossil.html'>Fossil</a></li></ul><li class='has-children'><a href='Topic1.html'>Topic1</a><ul class='dropdown'><li><a href='w1.html'>w1</a><li><a href='Portable.html'>Portable</a><li><a href='repo.html'>repo</a><li><a href='SSH.html'>SSH</a><li><a href='list.html'>list</a><li><a href='IPv6.html'>IPv6</a></li></ul><li class='has-children'><a href='Topic2.html'>Topic2</a><ul class='dropdown'><li><a href='Compile.html'>Compile</a><li><a href='Onshape.html'>Onshape</a></li></ul><li class='has-children'><a href='Topic3.html'>Topic3</a><ul class='dropdown'><li><a href='Fourbar2.html'>Fourbar2</a><li><a href='boomer.html'>boomer</a></li></ul><li class='has-children'><a href='Topic4.html'>Topic4</a><ul class='dropdown'><li><a href='ROS2.html'>ROS2</a></li></li></ul></ul><li class='has-children'><a href='HW.html'>HW</a><ul class='dropdown'><li><a href='HW1.html'>HW1</a><li><a href='HW2.html'>HW2</a><li><a href='HW3.html'>HW3</a></li></ul><li class='has-children'><a href='Exam.html'>Exam</a><ul class='dropdown'><li><a href='Exam1.html'>Exam1</a><li><a href='Exam2.html'>Exam2</a><li><a href='Exam3.html'>Exam3</a></li></ul><li><a href='rrr.html'>rrr</a><li><a href='Final.html'>Final</a><li class='has-children'><a href='Tutorial.html'>Tutorial</a><ul class='dropdown'><li class='has-children'><a href='Fourbar.html'>Fourbar</a><ul class='dropdown'><li><a href='w10.html'>w10</a></li></ul><li class='has-children'><a href='Stage1.html'>Stage1</a><ul class='dropdown'><li><a href='Tutorial1.html'>Tutorial1</a><li><a href='Tutorial2.html'>Tutorial2</a></li></ul><li class='has-children'><a href='Stage2.html'>Stage2</a><ul class='dropdown'><li><a href='Tutorial3.html'>Tutorial3</a><li><a href='Distancesensor.html'>Distancesensor</a><li><a href='Tutorial4.html'>Tutorial4</a><li><a href='Tutorial5.html'>Tutorial5</a></li></ul><li class='has-children'><a href='Stage3.html'>Stage3</a><ul class='dropdown'><li><a href='Tutorial6.html'>Tutorial6</a><li><a href='Tutorial7.html'>Tutorial7</a><li><a href='Stream.html'>Stream</a><li><a href='Webots Server.html'>Webots Server</a></li></ul><li class='has-children'><a href='Solvespace.html'>Solvespace</a><ul class='dropdown'><li><a href='Learn_Solvs.html'>Learn_Solvs</a></li></ul><li><a href='Pyslvs-UI.html'>Pyslvs-UI</a><li><a href='PICSimLab.html'>PICSimLab</a><li><a href='Fossil SCM.html'>Fossil SCM</a><li><a href='Leo Editor.html'>Leo Editor</a><li><a href='uv.html'>uv</a><li><a href='Old.html'>Old</a></li></ul><li><a href='Brython.html'>Brython</a></li>
                      </ul>
                </nav>
              </div>
              <div class="d-inline-block d-xl-none ml-md-0 mr-auto py-3" style="position: relative; top: 3px;"><a href="#" class="site-menu-toggle js-menu-toggle text-black"><span class="icon-menu h3"></span></a></div>
              </div>

            </div>
          </div>
          
        </header>
    <div id="tipue_search_content">Tutorial << <a href='Tutorial.html'>Previous</a> <a href='w10.html'>Next</a> >> w10<br /><h1>Fourbar</h1>
<h4>onelink</h4>
<p><a href="./../downloads/onelink_webots.7z">onelink_webots.7z</a> (直接採 Shape 建模)</p>
<p><a href="./../downloads/fourbar_box_w8.7z">fourbar_box_w8.7z</a> (將 joint4 接在 link3 末端, 然後 <a href="https://cyberbotics.com/doc/reference/solidreference">solidReference</a> 參照到內定的 &lt;static environment&gt;, 表示將 link3 末端的 joint4 直接固定在 base 上 (固定點)</p>
<p><a href="./../downloads/onelink_slvs.7z">onelink_slvs.7z</a> (利用 Solvespace 繪製組立檔案, 轉為 STL 後, 再分割為 STL 零件與 OBJ 零件後, 將 OBJ 零件 import 進 Blender 確認零件名稱, 各 OBJ 零件分別利用 Solid 與 CadShape 節點建立從屬關係, 最後加入 hinge 旋轉軸與 Python 控制程式, 讓單一機械臂以 30deg/s 速度轉動)</p>
<p style="padding-left: 30px;">onelink_w_hinge.wbt 直接在場景樹狀結構中定義 Solid (可用於較簡單的零組件系統)</p>
<p style="padding-left: 30px;">onelink_w_hinge2.wbt 則將各零件以 PROTO 定義為原型節點, 之後在場景中導入後引用 (適合較複雜的零組件系統)</p>
<h4>fourbar1</h4>
<p>以下利用 box 建立 Webots 平面四連桿場景:</p>
<p>層次結構：</p>
<p style="padding-left: 30px;">Robot → BASE</p>
<p style="padding-left: 30px;">Robot → JOINT1 → LINK1 → JOINT2 → LINK2 → JOINT3 → LINK3</p>
<p style="padding-left: 30px;">Robot → JOINT4 (closed chain 約束)</p>
<p><img caption="false" height="183" src="./../images/Webots_fourbar_box_tree.png" width="200"/></p>
<p>base shape and coordinate setup:</p>
<p>建立 Box 時的局部座標系統原點位於 Box Shape 中心, 由於 Box x 方向長度 1m, 因此將整體往 x 方向移動長度的一半 (即 0.5m), 可讓隨後定位完成的 link1 依照此座標系統指定旋轉中心.</p>
<p><img alt="" height="209" src="./../images/Webots_base_coord_setup.png" width="200"/></p>
<p>幾何關係：</p>
<p style="padding-left: 30px;">所有關節都繞 z 軸旋轉</p>
<p style="padding-left: 30px;">連桿長度分別為 0.4m、0.6m、0.9m</p>
<p style="padding-left: 30px;">基座長度為 1m</p>
<p>物理特性：</p>
<p style="padding-left: 30px;">所有連桿質量為 0.1kg</p>
<p style="padding-left: 30px;">使用密度為 -1 表示質量優先於密度</p>
<p style="padding-left: 30px;">馬達最大速度 1rad/s，最大扭矩 100N⋅m</p>
<p>控制系統：</p>
<p style="padding-left: 30px;">使用 "fourbar_controller" 控制器</p>
<p style="padding-left: 30px;">包含位置感測器和馬達裝置</p>
<p><a href="./../downloads/fourbar_box.7z">fourbar_box.7z</a></p>
<p>1.</p>
<p><img alt="" height="222" src="./../images/webots_w5_1.png" width="231"/></p>
<p>2.</p>
<p><img alt="" height="367" src="./../images/webots_w5_2.png" width="245"/></p>
<p>3.</p>
<p><img alt="" height="270" src="./../images/webots_w5_3.png" width="253"/></p>
<p>4.</p>
<p><img alt="" height="322" src="./../images/webots_w5_4.png" width="800"/></p>
<p>5.</p>
<p><img alt="" height="470" src="./../images/webots_w5_5.png" width="363"/></p>
<p>6.</p>
<p><img alt="" height="332" src="./../images/webots_w5_6.png" width="800"/></p>
<p>7.</p>
<p><img alt="" height="389" src="./../images/webots_w5_7.png" width="800"/></p>
<p>8.</p>
<p><img alt="" height="331" src="./../images/webots_w5_8.png" width="295"/></p>
<h4>handon1</h4>
<p>啟動 Webots 2025a:</p>
<p style="padding-left: 30px;">啟動可攜程式系統後, 可以在 cmd 命令視窗中執行 webotsw, 就可以啟動 Webots.</p>
<p>建立 Robot 模擬場景:</p>
<p style="padding-left: 30px;">建立模擬場景可以在既有的 WorldInfo、ViewPoint、TextureBackground 以及 TextureBackgroundLight, 建立一個 Robot 節點.</p>
<p>利用 children 數列節點, 納入子節點:</p>
<p style="padding-left: 30px;">之後的物件節點都可以在 Robot 節點中的 children 數列節點中建立, Robot 與 Solid 節點中都包含 children 數列節點, 表示這樣的節點可以透過 children 放入更多的子節點, 其中更包括將其他 Robot 與 Solid 節點納入作為子節點.</p>
<p>在 Shape 節點中建立標準物件:</p>
<p style="padding-left: 30px;">至於 Shape 節點中, 就沒有 children 數列節點的設置, 只能根據其既有的節點屬性進行配置. 相較於 Solid 節點 Shape 節點的功能只能放入對應的標準物件, 例如: 目前這個範例會用到的 Box.</p>
<p>物件的移動與旋轉:</p>
<p style="padding-left: 30px;">而 Robot 與 Solid 節點, 除了本身具備座標轉換的平移及旋轉術性外, 還能利用其中的 children 數列節點, 加入 Pose 節點進行子節點內的座標轉換, 還可利用 Transform 節點調整物件的 scale.</p>
<p>利用 CAD 繪圖 (Solvespace 或 Siemens NX) 協助機構定位:</p>
<p style="padding-left: 30px;">本頁面的目的是利用 Webots 的 box 建立一個平面四連桿機構的模擬場景, 機構的尺寸設計必須從 Solvespace 的繪圖開始, 除了選擇各桿件的尺寸外, 還需提供各連桿的初始位置以及連桿方位, 才能透過 HingeJoint 以及 SolidReference 等兩個節點的配置, 完成平面四連桿的封閉機構約束設置.</p>
<p>物件的座標系統:</p>
<p style="padding-left: 30px;">在 Webots 中建立模擬場景, 很重要的一項工作就是確認每一個物件場景的座標系統, 尤其是在某一物件節點中配置各種 Joint 之後, 隨後接在此 Joint 上的物件都將依據其 parent 座標系統定位.</p>
<p>連接軸樹狀架構與 CoppeliaSim 的差異:</p>
<p style="padding-left: 30px;">此外 Webots 在配置 Joint 時的樹狀結構與 CoppeliaSim 有很大的差別, CoppeliaSim 的 Joint 物件位階是設定為 parent 物件的子物件, 而 Weobts 場景中的 Joint 節點則必須配置成與其 parent 節點相同位階.</p>
<p>利用 Box 建立平面四連桿模擬場景:</p>
<p style="padding-left: 30px;">以下的配置圖是希望平面四連桿的固定桿件長度為 1m, 且透過 Top view 視圖觀測時, 會水平置放. 在 Robot 節點中的 children 建立 Solid 時使用 DEF 命名為 base, 隨後若要使用此 Solid, 就可以透過 USE base 引用.</p>
<p style="padding-left: 30px;">但若此 DEF 命名物件之後, 內部的 Solid 物件自行移動 (例如: 透過 Pose), 則利用 USE base 作為 boundingObject 時, 也必須配合 Pose 移動至 Solid 所在位置. 如此才可在物件的碰撞檢測中, 正確配置物件的實體範圍.</p>
<p>起始座標定位方法一:</p>
<p>為了之後在此固定節點的左側建立 joint1, 因此將 base 平移 0.5m, 以便讓隨後配置的 HingeJoint 可以採用此座標系統進行配置. 但利用滑鼠點選 DEF base Solid 時, 可以發現物件的座標系統仍位於其物件中心:</p>
<p><img caption="false" height="201" src="./../images/webots_obj_coord.png" width="400"/></p>
<p>但若將滑鼠停到 Robot 的節點上, 目前的廣域座標系統已經因為 translation 0.5 0 0 而移動到 base 的最左側, 因此隨後配置的 HingeJoint 將會依照此廣域座標系統進行後續配置:</p>
<p><img alt="" height="200" src="./../images/webots_robot_coord.png" width="400"/></p>
<p>起始座標定位方法二:</p>
<p>上列做法在一開始就先移動 base 物件, 讓隨後的 Joint1 定位中心可直接位於 base 左端. 若 base 物件不希望移動 (當 base 連桿與其他機構有特定對應位置時), 則隨後的 Joint1 就必須以 base 物件的中心點座標為基準, 然後在此基準建立 link1 物件之後, 先將 link1 移動至 base 最左端後旋轉 90 度, 這時的 x 軸將向上為正, 只要再沿著 x 軸移動 link1 長度的一半, 就可以完成 link1 的定位.</p>
<p>至於採用此方法的 Joint1 參考座標原點是位於 base 的中心點, 因此 link1 以 Joint1 旋轉的 anchor 中心點座標必須設為 -0.5 0 0.</p>
<p>之後的 link2 與 Joint2 的相關設置, 也可以採用先移動物件中心再旋轉至該連桿的起始方位後, 再對機構進行 x 軸方向的移動, 且對應旋轉的 Joint2 anchor 也必須配合設置當下的連桿參考座標系統.</p>
<p>box 平面四連桿的 Robot 節點架構:</p>
<p style="padding-left: 30px;">在 BASE 物件上設置兩個旋轉軸 (JOINT1 與 JOINT4):</p>
<p style="padding-left: 30px;">其中的 JOINT1 上將接 link1, link1 上接 JOINT2, JOINT2 上接 link2, link2 上接 JOINT3, JOINT3 上接 link3, 意即從 BASE 上接了三個 joints, 以及三個 links, 形成一個 open chain 機構.</p>
<p style="padding-left: 30px;">然後在 JOINT4 連接 link3 的設置時, 透過 SolidReference 節點, 指定 link3 作為 solidName 後, 將此條件作為 closed chain 的約束運算.</p>
<p style="padding-left: 30px;">再加上從 CAD 繪圖中取得的各連桿起始位置, 就可以結合連桿的 physics 與 boundingObject 屬性設置, 完成 Webots 上的平面四連桿場景.</p>
<p><img alt="" height="163" src="./../images/Webots_box_fourbar1.png" width="200"/></p>
<p>在 BASE 上配置 JOINT1, JOINT1 末端配置 LINK1, LINK1 上再配置 JOINT2 的樹狀架構圖如下:</p>
<p><img caption="false" height="313" src="./../images/Webots_box_fourbar2.png" width="250"/></p>
<p>將 Robot 命名為 four_bar_linkage, 並利用名稱為 fourbar_controller 的控制器進行控制:</p>
<p><img caption="false" height="304" src="./../images/Webots_box_fourbar3.png" width="400"/></p>
<h4>fourbar2</h4>
<p>Webots 中平面四連桿機構的設置方式：</p>
<p>四連桿結構應該是：</p>
<ol>
<li>
<p><strong>第一條運動鏈</strong>：</p>
<ul>
<li>從 BASE 出發的 JOINT1</li>
<li>JOINT1 連接 LINK1</li>
<li>LINK1 上的 JOINT2 連接 LINK2</li>
<li>LINK2 上的 JOINT3 連接 LINK3</li>
</ul>
</li>
<li>
<p><strong>第二條運動鏈（closed chain）</strong>：</p>
<ul>
<li>從 BASE 出發的 JOINT4</li>
<li>JOINT4 的 endPoint 設為 SolidReference</li>
<li>SolidReference 的 solidName 設為 "LINK3"</li>
</ul>
</li>
</ol>
<p>這樣的結構是正確的，因為：</p>
<ol>
<li>主要運動鏈（JOINT1 → LINK1 → LINK2 → LINK3）形成一個序列結構</li>
<li>閉鎖鏈（JOINT4 → LINK3）通過 SolidReference 連接回主鏈的末端</li>
<li>這樣可以形成一個完整的閉環運動結構</li>
</ol>
<p>基本結構示意：</p>
<p>BASE<br/>├── JOINT1 → LINK1 → JOINT2 → LINK2 → JOINT3 → LINK3<br/>└── JOINT4 ------(SolidReference: "LINK3")--------┘</p>
<p>PROTO 結構：</p>
<pre class="brush:wbt;auto-links:false;toolbar:false" contenteditable="false">Robot {
  children [
    BASE {
      ...
    }
    HingeJoint {  # JOINT1
      endPoint Solid {  # LINK1
        children [
          ...
          HingeJoint {  # JOINT2
            endPoint Solid {  # LINK2
              children [
                ...
                HingeJoint {  # JOINT3
                  endPoint Solid {  # LINK3
                    ...
                  }
                }
              ]
            }
          }
        ]
      }
    }
    HingeJoint {  # JOINT4
      endPoint SolidReference {
        solidName "LINK3"
      }
    }
  ]
}</pre>
<p>上列設置確保：</p>
<ol>
<li>機構能夠正確形成閉環</li>
<li>運動學約束能夠正確傳遞</li>
<li>物理模擬能夠正常進行</li>
</ol>
<p>此外，為了使機構運作正常，還需要：</p>
<ol>
<li>正確設置各個 joint 的旋轉軸（axis）</li>
<li>準確定義各個 joint 的錨點（anchor）</li>
<li>確保所有連桿的物理屬性正確設置</li>
</ol>
<p><a href="./../downloads/fourbar_slvs.7z">fourbar_slvs.7z</a></p>
<h4>DEF</h4>
<p><a href="https://cyberbotics.com/doc/reference/def-and-use">https://cyberbotics.com/doc/reference/def-and-use</a></p>
<p>Although it is permitted to name any node using the DEF keyword, <span style="background-color: #ffff99;">there are some exceptions where USE nodes are not valid. A USE node is an exact copy of the corresponding DEF node, and thus no property of a USE node can change independently from the DEF node.</span></p>
<p>For this reason it is not allowed to insert USE nodes of <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/solid">Solid</a>, <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/joint">Joint</a>, <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/jointparameters">JointParameters</a>, <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/trackwheel">TrackWheel</a>, and <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/balljointparameters">BallJointParameters</a> nodes and their derived nodes. Indeed, the ability for identical solids or joints to occupy the same position is useless, if not hazardous, in a physics simulation. To safely duplicate one of these nodes, you can design a <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/proto">PROTO</a> model for this node and then add different PROTO instances to your world.</p>
<p>The same principle applies to <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/material">Material</a> and <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/light">Light</a> nodes located in the first child of <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/charger">Charger</a> and <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/led">LED</a> nodes whose emissive color changes automatically based on the <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/charger">Charger</a> energy and <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/led">LED</a> setup.</p>
<p>Also the <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/texturetransform">TextureTransform</a> of the first <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/shape">Shape</a> in the <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/track">Track</a> device with enabled texture animation cannot be a USE node given that the translation values will be automatically updated by Webots while the <a class="dynamicLoad" href="https://cyberbotics.com/doc/reference/track">Track</a> device is moving.</p>
<p><strong>Webots</strong> 使用 <strong>DEF</strong> 和 <strong>USE</strong> 關鍵字來命名和重複使用節點的限制：</p>
<ol>
<li>
<p><strong>DEF 和 USE 節點：</strong></p>
<ul>
<li>
<p><code>DEF</code> 關鍵字用來命名一個節點，這個節點可以在場景中多次使用。</p>
</li>
<li>
<p><code>USE</code> 節點是 <code>DEF</code> 節點的精確複製，因此 <code>USE</code> 節點的所有屬性都會與它所引用的 <code>DEF</code> 節點完全相同，無法獨立修改其屬性。</p>
</li>
</ul>
</li>
<li>
<p><strong>某些節點不能使用 USE：</strong></p>
<ul>
<li>
<p>有些節點不能作為 <code>USE</code> 節點使用，這些節點包括 <span style="background-color: #ffff99;"><strong>Solid</strong>、<strong>Joint</strong>、<strong>JointParameters</strong>、<strong>TrackWheel</strong> 和 <strong>BallJointParameters</strong> 節點以及它們的衍生節點</span>。原因是，在物理仿真中，讓相同的實體或關節出現於相同位置是沒有意義的，甚至會帶來危險。例如，物理仿真需要每個實體或關節能夠獨立運動和改變位置，使用 <code>USE</code> 節點可能會導致錯誤的物理行為。</p>
</li>
<li>
<p>若要安全地重複這些節點，應該使用 <strong>PROTO</strong> 模型來設計這些節點，並為每個需要的實例創建不同的 <strong>PROTO</strong> 實例，這樣可以避免重複的節點引起問題。</p>
</li>
</ul>
</li>
<li>
<p><strong>特殊節點的限制：</strong></p>
<ul>
<li>
<p>同樣的原則也適用於某些特殊節點，如 <span style="background-color: #ffff99;"><strong>Material</strong> 和 <strong>Light</strong> 節點</span>，這些節點通常是位於 <strong>Charger</strong> 和 <strong>LED</strong> 節點的第一個子節點內。這些節點的發光顏色會根據充電器的能量或 LED 的設置自動變化，因此不能用 <code>USE</code> 來複製，否則會引起不一致的行為。</p>
</li>
</ul>
</li>
<li>
<p><strong>Track 設備的限制：</strong></p>
<ul>
<li>
<p>如果 Track 設備啟用了紋理動畫，則 Track 設備中的第一個 <strong>Shape</strong> 節點的 <strong>TextureTransform</strong> 也不能使用 <code>USE</code>。這是因為 Webots 會在 Track 設備移動時自動更新其平移（Translation）值，使用 <code>USE</code> 節點會使這些自動更新失效，從而導致動畫或行為不正確。</p>
</li>
</ul>
</li>
</ol>
<p>Forbar Linkage the first link:</p>
<pre class="brush:wbt;auto-links:false;toolbar:false" contenteditable="false">#VRML_SIM R2025a utf8

EXTERNPROTO "../protos/TexturedBackground.proto"
EXTERNPROTO "../protos/TexturedBackgroundLight.proto"

WorldInfo {
  info [
    "fourbar linkage"
  ]
}
Viewpoint {
  orientation -0.17524366601960317 0.20799757991102616 0.9623027924053665 1.7913508311753839
  position 1.0571588458938594 -2.502126861220829 1.490364369030099
}
TexturedBackground {
}
TexturedBackgroundLight {
}
DEF FOURBAR Robot {
  children [
    DEF BASE Solid {
      children [
        CadShape {
          url [
            "../split_parts/base.obj"
          ]
        }
      ]
      name "BASE"
    }
    DEF JOINT1 HingeJoint {
      jointParameters HingeJointParameters {
        axis 0 0 1
      }
      device [
        RotationalMotor {
          name "joint_motor1"
        }
      ]
      endPoint DEF LINK1 Solid {
        children [
          CadShape {
            url [
              "../split_parts/link1.obj"
            ]
          }
        ]
        name "LINK1"
      }
    }
  ]
}
</pre>
<p>Webots 中平面四連桿機構的設置方式：</p>
<p>四連桿結構應該是：</p>
<ol>
<li>
<p><strong>第一條運動鏈</strong>：</p>
<ul>
<li>從 BASE 出發的 JOINT1</li>
<li>JOINT1 連接 LINK1</li>
<li>LINK1 上的 JOINT2 連接 LINK2</li>
<li>LINK2 上的 JOINT3 連接 LINK3</li>
</ul>
</li>
<li>
<p><strong>第二條運動鏈（closed chain）</strong>：</p>
<ul>
<li>從 BASE 出發的 JOINT4</li>
<li>JOINT4 的 endPoint 設為 SolidReference</li>
<li>SolidReference 的 solidName 設為 "LINK3"</li>
</ul>
</li>
</ol>
<p>這樣的結構是正確的，因為：</p>
<ol>
<li>主要運動鏈（JOINT1 → LINK1 → LINK2 → LINK3）形成一個序列結構</li>
<li>閉鎖鏈（JOINT4 → LINK3）通過 SolidReference 連接回主鏈的末端</li>
<li>這樣可以形成一個完整的閉環運動結構</li>
</ol>
<p>基本結構示意：</p>
<p>BASE<br/>├── JOINT1 → LINK1 → JOINT2 → LINK2 → JOINT3 → LINK3<br/>└── JOINT4 ------(SolidReference: "LINK3")--------┘</p>
<p>PROTO 結構：</p>
<pre class="brush:wbt;auto-links:false;toolbar:false" contenteditable="false">Robot {
  children [
    BASE {
      ...
    }
    HingeJoint {  # JOINT1
      endPoint Solid {  # LINK1
        children [
          ...
          HingeJoint {  # JOINT2
            endPoint Solid {  # LINK2
              children [
                ...
                HingeJoint {  # JOINT3
                  endPoint Solid {  # LINK3
                    ...
                  }
                }
              ]
            }
          }
        ]
      }
    }
    HingeJoint {  # JOINT4
      endPoint SolidReference {
        solidName "LINK3"
      }
    }
  ]
}</pre>
<p>上列設置確保：</p>
<ol>
<li>機構能夠正確形成閉環</li>
<li>運動學約束能夠正確傳遞</li>
<li>物理模擬能夠正常進行</li>
</ol>
<p>此外，為了使機構運作正常，還需要：</p>
<ol>
<li>正確設置各個 joint 的旋轉軸（axis）</li>
<li>準確定義各個 joint 的錨點（anchor）</li>
<li>確保所有連桿的物理屬性正確設置</li>
</ol>
<p><a href="./../downloads/fourbar_slvs.7z">fourbar_slvs.7z</a></p>
<br />Tutorial << <a href='Tutorial.html'>Previous</a> <a href='w10.html'>Next</a> >> w10</div>
        
    <!-- footer -->
      <div class="container">
        <div class="row pt-3 mx-auto">
            <p>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            Copyright &copy;<script>document.write(new Date().getFullYear());</script> All rights reserved | This template is made with <i class="icon-heart" aria-hidden="true"></i> by <a href="https://colorlib.com" target="_blank" >Colorlib</a>
            <!-- Link back to Colorlib can't be removed. Template is licensed under CC BY 3.0. -->
            </p>
        </div>
      </div>
    <!-- for footer -->
    
        </div> <!-- for site wrap -->
            <!-- <script src="../cmsimde/static/chimper/js/jquery-3.3.1.min.js"></script> -->
            <script src="../cmsimde/static/chimper/js/jquery-migrate-3.0.1.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery-ui.js"></script>
            <script src="../cmsimde/static/chimper/js/popper.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap.min.js"></script>
            <script src="../cmsimde/static/chimper/js/owl.carousel.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.stellar.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.countdown.min.js"></script>
            <script src="../cmsimde/static/chimper/js/jquery.magnific-popup.min.js"></script>
            <script src="../cmsimde/static/chimper/js/bootstrap-datepicker.min.js"></script>
            <script src="../cmsimde/static/chimper/js/aos.js"></script>
            <!--
            <script src="../cmsimde/static/chimper/js/typed.js"></script>
                    <script>
                    var typed = new Typed('.typed-words', {
                    strings: ["Web Apps"," WordPress"," Mobile Apps"],
                    typeSpeed: 80,
                    backSpeed: 80,
                    backDelay: 4000,
                    startDelay: 1000,
                    loop: true,
                    showCursor: true
                    });
                    </script>
            -->
            <script src="../cmsimde/static/chimper/js/main.js"></script>
        
<!-- 啟用 LaTeX equations 編輯 -->
  <!-- <script>
  MathJax = {
    tex: {inlineMath: [['$', '$'], ['\(', '\)']]}
  };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>-->
    </body></html>
        